
# General Settings
app:
  name: "YPI Al-Azhar RAG Chatbot"
  version: "1.0.0"
  environment: "development"

# ============================================================================
# CHUNKING CONFIGURATION
# ============================================================================
chunking:
  strategy: "fixed_size"
  
  fixed_size:
    chunk_size: 1000
    chunk_overlap: 200
    separators:
      - "\n\n"
      - "\n"
      - "."
      - " "
      - ""

# ============================================================================
# EMBEDDING CONFIGURATION
# ============================================================================
embeddings:
  provider: "openai"  # openai atau huggingface
  
  openai:
    model_name: "text-embedding-3-small"
    dimensions: 1536
  
  huggingface:
    model_name: "sentence-transformers/all-MiniLM-L6-v2"
    dimensions: 384
    device: "cpu"

# ============================================================================
# VECTOR DATABASE (ChromaDB)
# ============================================================================
vectordb:
  type: "chroma"
  chroma:
    collection_name: "ypi_knowledge_base"
    persist_directory: "data/chroma_db"
    distance_function: "cosine"

# ============================================================================
# RETRIEVAL CONFIGURATION
# ============================================================================
retrieval:
  # Initial retrieval
  top_k: 10                      # Ambil lebih banyak untuk di-filter
  similarity_threshold: 0.4      # Minimum similarity (0-1)
  
  # Document aggregation
  max_documents: 3               # Max dokumen unik setelah aggregation
  fetch_full_document: true      # KUNCI: Fetch semua chunks per dokumen
  
  # Reranker (optional)
  reranker:
    enabled: false
    model: "cross-encoder/ms-marco-MiniLM-L-6-v2"
    top_n: 5

# ============================================================================
# LLM CONFIGURATION
# ============================================================================
llm:
  provider: "openai"  # openai, gemini, atau ollama
  
  openai:
    model: "gpt-4o-mini"
    temperature: 0
    max_tokens: 1024
    streaming: true
    
  gemini:
    model: "gemini-2.0-flash"
    temperature: 0
    max_tokens: 1024
    
  ollama:
    model: "llama3"
    temperature: 0
    max_tokens: 1024
    system_prompt_prefix: "PENTING: Selalu jawab dalam Bahasa Indonesia."

# ============================================================================
# PROMPTS CONFIGURATION
# ============================================================================
prompts:
  informational:
    # ===========================================================================
    # SYSTEM PROMPT - Instruksi dasar untuk LLM
    # ===========================================================================
    system_prompt: |
      ATURAN UTAMA - WAJIB DIPATUHI:
      ================================
      1. Anda HARUS SELALU menjawab dalam BAHASA INDONESIA
      2. JANGAN PERNAH menjawab dalam bahasa Inggris atau bahasa lain
      3. Jika konteks/dokumen dalam bahasa Inggris, TETAP jawab dalam Bahasa Indonesia
      
      IDENTITAS:
      ==========
      Anda adalah asisten virtual resmi Yayasan Pesantren Islam Al-Azhar Jakarta.
      
      TUGAS ANDA:
      ===========
      - Memberikan informasi akurat tentang kebijakan, biaya, program, dan layanan YPI Al-Azhar
      - Menjawab pertanyaan berdasarkan dokumen resmi yang diberikan
      - Menggunakan Bahasa Indonesia yang sopan dan profesional
      - Jika informasi tidak tersedia, katakan dengan jelas
      
      PANDUAN PENTING:
      ================
      - Selalu rujuk ke dokumen resmi dalam konteks
      - WAJIB menyebutkan TAHUN/PERIODE dokumen jika tersedia
      - Gunakan format yang jelas dan mudah dipahami
      - Jika ada angka/biaya, sebutkan dengan jelas beserta tahunnya
      - Contoh format: "Berdasarkan dokumen tahun 2024/2025, biaya SPP adalah Rp..."

    # ===========================================================================
    # QUERY PROMPT - Template untuk menjawab pertanyaan
    # ===========================================================================
    query_prompt: |
      INSTRUKSI WAJIB:
      ================
      1. Jawab HANYA dalam BAHASA INDONESIA
      2. SEBUTKAN TAHUN/PERIODE dokumen jika ada
      3. Format: "Berdasarkan dokumen [nama/tahun], ..."
      4. ⚠️ JIKA KONTEKS TIDAK RELEVAN DENGAN PERTANYAAN, KATAKAN: "Maaf, saya tidak menemukan informasi tentang [topik] dalam database saya."
      
      Pertanyaan: {question}
      
      Konteks dari dokumen resmi YPI Al-Azhar:
      ----------------------------------------
      {context}
      ----------------------------------------
      
      ATURAN MENJAWAB:
      ================
      1. Baca konteks dengan teliti
      2. **CEK RELEVANSI**: Apakah konteks menjawab pertanyaan?
         - Jika YA → Jawab berdasarkan konteks
         - Jika TIDAK → Katakan "Maaf, informasi tidak tersedia"
      3. **WAJIB** sebutkan tahun/periode jika ada dalam dokumen
      4. **JANGAN PERNAH** menjawab jika konteks tidak relevan
         Contoh:
         - Pertanyaan: "Biaya di Padang?"
         - Konteks: Dokumen Cibinong
         - Jawaban: "Maaf, saya tidak menemukan informasi tentang Padang dalam database."
      
      5. Jika konteks relevan tapi tidak lengkap: "Berdasarkan dokumen yang tersedia, [jawaban]. Untuk informasi lebih detail, silakan hubungi [kontak]."
      
      Jawaban (dalam Bahasa Indonesia):

    # ===========================================================================
    # NO CONTEXT RESPONSE - Jika tidak ada dokumen relevan
    # ===========================================================================
    no_context_response: |
      Maaf, saya tidak menemukan informasi yang relevan dalam database dokumen YPI Al-Azhar.
      
      Silakan coba:
      1. Ubah kata kunci pertanyaan Anda
      2. Tanyakan dengan lebih spesifik (sebutkan jenjang: TK/SD/SMP/SMA)
      3. Hubungi langsung pihak sekolah untuk informasi terbaru

    # ===========================================================================
    # LOW RELEVANCE RESPONSE - Jika similarity rendah
    # ===========================================================================
    low_relevance_response: |
      Maaf, saya tidak yakin dengan informasi yang ditemukan karena relevansinya rendah.
      Silakan coba pertanyaan yang lebih spesifik atau hubungi langsung pihak sekolah.

# ============================================================================
# OCR CONFIGURATION
# ============================================================================
ocr:
  method: "unstructured"
  unstructured:
    strategy: "hi_res"
    extract_images: true
    extract_tables: true

# ============================================================================
# DATABASE
# ============================================================================
database:
  type: "postgresql"
  host: "${DB_HOST}"
  port: "${DB_PORT}"
  name: "${DB_NAME}"
  user: "${DB_USER}"
  password: "${DB_PASSWORD}"

# ============================================================================
# LOGGING
# ============================================================================
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "logs/chatbot.log"