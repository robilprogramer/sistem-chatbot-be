# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# -----------------------------------------------------------------------------
# APP SETTINGS
# -----------------------------------------------------------------------------
app:
  name: "YPI Al-Azhar Chatbot"
  version: "1.0.0"
  debug: ${DEBUG:false}
  
# -----------------------------------------------------------------------------
# SERVER
# -----------------------------------------------------------------------------
server:
  host: ${API_HOST:0.0.0.0}
  port: ${API_PORT:8000}
  reload: ${DEBUG:false}
  
  # API Prefixes
  informational_prefix: ${INFORMATIONAL_API_PREFIX:/api/informational/v1}
  transactional_prefix: ${TRANSACTIONAL_API_PREFIX:/api/transactional/v1}
  
# -----------------------------------------------------------------------------
# DATABASE
# -----------------------------------------------------------------------------
database:
  url: ${DATABASE_URL:postgresql://postgres:admin123@localhost:5432/ypi_alazhar}
  pool_size: 5
  max_overflow: 10
  echo: ${DEBUG:false}
  
# -----------------------------------------------------------------------------
# LLM PROVIDER
# -----------------------------------------------------------------------------
llm:
  provider: ${LLM_PROVIDER:openai}
  
  openai:
    api_key: ${OPENAI_API_KEY:}
    model: ${OPENAI_MODEL:gpt-4o-mini}
    temperature: ${OPENAI_TEMPERATURE:0.7}
    max_tokens: ${OPENAI_MAX_TOKENS:500}
    
  anthropic:
    api_key: ${ANTHROPIC_API_KEY:}
    model: ${ANTHROPIC_MODEL:claude-3-sonnet-20240229}
    temperature: 0.7
    max_tokens: 500
    
# -----------------------------------------------------------------------------
# SESSION
# -----------------------------------------------------------------------------
session:
  timeout_seconds: ${SESSION_TIMEOUT:3600}
  max_conversation_history: ${MAX_CONVERSATION_HISTORY:20}
  storage: "memory"  # "memory" atau "redis"
  
  redis:
    url: ${REDIS_URL:redis://localhost:6379/0}
    prefix: "ypi_session:"
    
# -----------------------------------------------------------------------------
# FILE UPLOAD
# -----------------------------------------------------------------------------
upload:
  directory: ${UPLOAD_DIR:./uploads}
  max_file_size_mb: 5
  allowed_extensions:
    - ".pdf"
    - ".jpg"
    - ".jpeg"
    - ".png"
    
# -----------------------------------------------------------------------------
# SECURITY
# -----------------------------------------------------------------------------
security:
  secret_key: ${SECRET_KEY:change-this-in-production}
  algorithm: "HS256"
  access_token_expire_minutes: 30
  
# -----------------------------------------------------------------------------
# CORS
# -----------------------------------------------------------------------------
cors:
  origins:
    - "http://localhost:3000"
    - "http://localhost:8080"
    - ${CORS_ORIGIN:}
  allow_credentials: true
  allow_methods: ["*"]
  allow_headers: ["*"]
  
# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------
logging:
  level: ${LOG_LEVEL:INFO}
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: ${LOG_FILE:./logs/app.log}
  
# -----------------------------------------------------------------------------
# NOTIFICATIONS
# -----------------------------------------------------------------------------
notifications:
  email:
    enabled: ${EMAIL_ENABLED:false}
    smtp_host: ${SMTP_HOST:smtp.gmail.com}
    smtp_port: ${SMTP_PORT:587}
    smtp_user: ${SMTP_USER:}
    smtp_password: ${SMTP_PASSWORD:}
    from_email: ${FROM_EMAIL:noreply@ypiaalazhar.sch.id}
    from_name: "YPI Al-Azhar"
    
  webhook:
    enabled: ${WEBHOOK_ENABLED:false}
    url: ${WEBHOOK_URL:}
    secret: ${WEBHOOK_SECRET:}
    timeout_seconds: 10
    retry_count: 3
    
# -----------------------------------------------------------------------------
# REGISTRATION NUMBER FORMAT
# -----------------------------------------------------------------------------
registration:
  number_format: "AZHAR-{year}-{code}-{random}"
  code_mapping:
    Playgroup: "TK"
    "TK A": "TK"
    "TK B": "TK"
    "Kelas 1": "SD"
    "Kelas 2": "SD"
    "Kelas 3": "SD"
    "Kelas 4": "SD"
    "Kelas 5": "SD"
    "Kelas 6": "SD"
    "Kelas 7": "SMP"
    "Kelas 8": "SMP"
    "Kelas 9": "SMP"
    "Kelas 10": "SMA"
    "Kelas 11": "SMA"
    "Kelas 12": "SMA"
  default_code: "XX"

# -----------------------------------------------------------------------------
# INFORMATIONAL API (RAG Chatbot)
# -----------------------------------------------------------------------------
informational_api:
  enabled: ${INFORMATIONAL_API_ENABLED:true}
  base_url: ${INFORMATIONAL_API_URL:http://localhost:8080/api/v1}
  api_key: ${INFORMATIONAL_API_KEY:}
  chat_endpoint: ${INFORMATIONAL_CHAT_ENDPOINT:/chat}
  timeout: ${INFORMATIONAL_API_TIMEOUT:30}
  retry_count: 3
  retry_delay: 1